<input type="file" id="image_input" />
<button onclick="uploadImage()">Обработать</button>
<div id="result"></div>
<img
  id="annotated_img"
  style="margin-top: 10px; max-width: 500px; display: none"
/>

<script>
  async function uploadImage() {
    const input = document.getElementById("image_input");
    if (input.files.length === 0) {
      alert("Выберите изображение!");
      return;
    }

    const formData = new FormData();
    formData.append("image", input.files[0]);

    const res = await fetch("/detect", { method: "POST", body: formData });
    const data = await res.json();

    if (data.error) {
      document.getElementById("result").textContent = data.error;
      document.getElementById("annotated_img").style.display = "none";
      return;
    }

    // Показываем JSON с объектами
    document.getElementById("result").textContent = JSON.stringify(
      data.objects,
      null,
      2
    );

    // Показываем аннотированное изображение
    const img = document.getElementById("annotated_img");
    img.src = "data:image/jpeg;base64," + data.image_base64;
    img.style.display = "block";
  }
</script>
